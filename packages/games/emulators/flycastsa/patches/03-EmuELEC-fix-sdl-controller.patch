diff --git a/core/sdl/sdl.cpp b/core/sdl/sdl.cpp
index 62467d08..cb167b4f 100644
--- a/core/sdl/sdl.cpp
+++ b/core/sdl/sdl.cpp
@@ -160,6 +160,11 @@ void input_sdl_init()
 #endif
 		std::string db = get_readonly_data_path("gamecontrollerdb.txt");
 		int rv = SDL_GameControllerAddMappingsFromFile(db.c_str());
+		if (rv < 0 && (nowide::getenv("SDL_GAMECONTROLLERCONFIG_FILE") != NULL))
+		{
+			db = (std::string) nowide::getenv("SDL_GAMECONTROLLERCONFIG_FILE");
+			rv = SDL_GameControllerAddMappingsFromFile(db.c_str());
+		}
 		if (rv < 0)
 		{
			db = get_readonly_config_path("gamecontrollerdb.txt");
--- a/core/archive/ZipArchive.cpp
+++ b/core/archive/ZipArchive.cpp
@@ -27,20 +27,8 @@ bool ZipArchive::Open(const char* path)

 bool ZipArchive::Open(const char* path)
 {
-       FILE *file = nowide::fopen(path, "rb");
-       if (file == nullptr)
-               return false;
-       zip_error_t error;
-       zip_source_t *source = zip_source_filep_create(file, 0, -1, &error);
-       if (source == nullptr)
-       {
-               std::fclose(file);
-               return false;
-       }
-       zip = zip_open_from_source(source, 0, NULL);
-       if (zip == nullptr)
-               zip_source_free(source);
-       return zip != nullptr;
+       zip = zip_open(path, 0, NULL);
+       return (zip != NULL);
 }

 ArchiveFile* ZipArchive::OpenFile(const char* name)
